<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kalkulator Marketplace</title>
    
    <style>
        input[type=number]::-webkit-inner-spin-button, 
        input[type=number]::-webkit-outer-spin-button { 
            -webkit-appearance: none;
            margin: 0;
        }
        input[type=number] {
            -moz-appearance: textfield; 
        }

        .calculator-container {
            font-family: Arial, sans-serif;
            background-color: #ffffff;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 450px;
            margin: auto;
        }

        .version-tag {
            text-align: center;
            color: #6c757d;
            font-size: 0.9em;
            margin-top: -20px; 
            margin-bottom: 25px; 
        }
        
        h2 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }

        .input-group {
            margin-bottom: 25px;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #000000;
            font-size: 1em;
        }

        .input-row {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .calculator-input {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 6px;
            box-sizing: border-box;
            font-size: 1em;
        }

        #modalPrice {
            width: 100%;
        }

        .percentage-input {
            width: 80px;
            text-align: right;
            font-weight: bold;
        }

        .slider-input {
            flex-grow: 1;
            height: 10px;
            -webkit-appearance: none;
            background: #e0e0e0;
            border-radius: 5px;
            cursor: pointer;
        }

        .slider-input::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #4CAF50;
            cursor: pointer;
            border: 3px solid #fff;
            box-shadow: 0 0 5px rgba(0, 0, 0, 0.2);
        }

        .slider-min-max {
            font-size: 0.8em;
            color: #999;
            margin-top: 5px;
            text-align: left;
        }

        .action-button {
            width: 100%;
            padding: 12px;
            background-color: #4CAF50;
            color: white;
            font-size: 1.1em;
            font-weight: bold;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.3s ease;
            margin-top: 15px;
        }

        .action-button:hover {
            background-color: #45a049;
        }
        
        .action-button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }


        hr {
            border: 0;
            height: 1px;
            background: #eee;
            margin: 20px 0;
        }

        .detailed-breakdown {
            margin-top: 15px;
            padding: 10px;
            border: 1px solid #f0f0f0;
            border-radius: 8px;
            background-color: #f9f9f9;
        }

        .detail-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            font-size: 1em;
            border-bottom: 1px dashed #eee;
        }

        .detail-row:last-child {
            border-bottom: none;
        }
        
        .result-header {
            padding: 10px 0;
            border-bottom: 2px solid #4CAF50;
            margin-bottom: 10px;
        }

        .result-header span {
            font-weight: bold;
        }
        
        .result-header strong {
            color: #4CAF50;
            line-height: 1.2; 
        }
        
        .profit-row {
            padding-top: 10px;
            border-top: 1px solid #ddd;
        }
        
        .profit-row span {
            font-weight: bold;
        }
        
        .profit-row strong {
            color: #FF9800;
            line-height: 1.2;
        }
    </style>
</head>
<body>

<div class="calculator-container">
    <h2>Kalkulator Marketplace</h2>
    
    <p class="version-tag">Versi 2.2 by Steven Alexander</p>
    
    <hr>
    
    <div class="input-group">
        <label for="modalPrice">Harga Modal (Rp)</label>
        <div class="input-row">
            <input type="number" id="modalPrice" class="calculator-input" value="100000" min="0">
        </div>
    </div>
    <div class="input-group slider-group">
        <label for="mpFeeRate">Biaya Layanan Marketplace (%)</label>
        <div class="input-row">
            <input type="range" id="mpFeeRateSlider" class="calculator-input slider-input" min="0" max="50" step="0.5" value="15">
            <input type="number" id="mpFeeRate" class="calculator-input percentage-input" value="15" min="0" max="100">
        </div>
        <p class="slider-min-max">Min: 0% | Max: 50%</p>
        <p class="slider-min-max">Silahkan Cek Biaya Layanan Per Kategori di Marketplace Kamu</p>
    </div>
    <div class="input-group slider-group">
        <label for="adsBudgetRate">Biaya Iklan / Ads (%)</label>
        <div class="input-row">
            <input type="range" id="adsBudgetRateSlider" class="calculator-input slider-input" min="0" max="50" step="0.5" value="10">
            <input type="number" id="adsBudgetRate" class="calculator-input percentage-input" value="10" min="0" max="100">
        </div>
        <p class="slider-min-max">Min: 0% | Max: 50%</p>
        <p class="slider-min-max">Alokasi Budget Marketplace / Meta / TikTok Ads</p>
    </div>
    <div class="input-group slider-group">
        <label for="affiliateBudgetRate">Biaya Komisi Affiliator (%)</label>
        <div class="input-row">
            <input type="range" id="affiliateBudgetRateSlider" class="calculator-input slider-input" min="0" max="50" step="0.5" value="5">
            <input type="number" id="affiliateBudgetRate" class="calculator-input percentage-input" value="5" min="0" max="100">
        </div>
        <p class="slider-min-max">Min: 0% | Max: 50%</p>
        <p class="slider-min-max">Alokasi Komisi Affiliator Setiap Produk Terjual</p>
    </div>
    <div class="input-group slider-group">
        <label for="operationalBudgetRate">Biaya Operasional (%)</label>
        <div class="input-row">
            <input type="range" id="operationalBudgetRateSlider" class="calculator-input slider-input" min="0" max="50" step="0.5" value="5">
            <input type="number" id="operationalBudgetRate" class="calculator-input percentage-input" value="5" min="0" max="100">
        </div>
        <p class="slider-min-max">Min: 0% | Max: 50%</p>
        <p class="slider-min-max">Alokasi Biaya Operasional : Gaji Karyawan, Sewa Tempat, Dll</p>
    </div>
    <div class="input-group slider-group">
        <label for="profitMarginRate">Profit Margin / Keuntungan (%)</label>
        <div class="input-row">
            <input type="range" id="profitMarginRateSlider" class="calculator-input slider-input" min="0" max="50" step="0.5" value="15">
            <input type="number" id="profitMarginRate" class="calculator-input percentage-input" value="15" min="0" max="100">
        </div>
        <p class="slider-min-max">Min: 0% | Max: 50%</p>
        <p class="slider-min-max">Tentukan Profit Yang Diinginkan, Dihitung Dari Harga Jual</p>
    </div>
    
    <hr>
    
    <div class="input-group">
        <label>Total Persentase Biaya & Profit (Max 100%)</label>
        <div class="input-row" style="padding: 10px; border: 1px solid #ddd; border-radius: 6px; background-color: #f0f8ff;">
            <strong id="totalVariableOutput" style="color: #4CAF50; flex-grow: 1; text-align: center;">0.0%</strong>
        </div>
    </div>
    
    <hr>
    <button id="calculateButton" class="action-button">Kalkulasi</button>
    <hr>
    
    <div class="detailed-breakdown">
        
        <div class="detail-row result-header">
            <span>Harga Jual Minimal</span>
            <strong id="minSellingPriceOutput">Rp 0</strong>
        </div>

        <div class="detail-row">
            <span>Biaya Layanan Marketplace</span>
            <strong id="mpFeeAmountOutput">Rp 0</strong>
        </div>
        <div class="detail-row">
            <span>Biaya Iklan / Ads</span>
            <strong id="adsAmountOutput">Rp 0</strong>
        </div>
        <div class="detail-row">
            <span>Biaya Komisi Affiliator</span>
            <strong id="affiliateAmountOutput">Rp 0</strong>
        </div>
        <div class="detail-row">
            <span>Biaya Operasional</span>
            <strong id="operationalAmountOutput">Rp 0</strong>
        </div>
        
        <div class="detail-row">
            <span>Harga Modal</span>
            <strong id="modalPriceOutput">Rp 0</strong>
        </div>
        
        <div class="detail-row profit-row">
            <span>Profit Margin / Keuntungan</span>
            <strong id="profitAmountOutput">Rp 0</strong>
        </div>
    </div>
</div>
</body>

<script>
    function formatCurrency(number) {
        if (isNaN(number) || number === null || number === undefined) {
            return 'Rp 0';
        }
        const roundedNumber = Math.round(number);
        return new Intl.NumberFormat('id-ID', {
            style: 'currency',
            currency: 'IDR',
            minimumFractionDigits: 0
        }).format(roundedNumber);
    }

    function formatModalPrice(inputElement) {
        let value = inputElement.value.replace(/\D/g, ''); 
        
        if (value) {
            const numberValue = parseInt(value, 10);
            inputElement.value = new Intl.NumberFormat('id-ID', {
                minimumFractionDigits: 0
            }).format(numberValue);
        } else {
            inputElement.value = '';
        }
    }

    function updateTotalVariable() {
        const mpFee = parseFloat(document.getElementById('mpFeeRate')?.value) || 0;
        const adsBudget = parseFloat(document.getElementById('adsBudgetRate')?.value) || 0;
        const affiliateBudget = parseFloat(document.getElementById('affiliateBudgetRate')?.value) || 0;
        const operationalBudget = parseFloat(document.getElementById('operationalBudgetRate')?.value) || 0;
        const profitMargin = parseFloat(document.getElementById('profitMarginRate')?.value) || 0;

        const totalRate = mpFee + adsBudget + affiliateBudget + operationalBudget + profitMargin;

        const totalOutput = document.getElementById('totalVariableOutput');
        const calculateButton = document.getElementById('calculateButton');
        
        if (totalOutput) {
            totalOutput.textContent = `${totalRate.toFixed(1)}%`;
            
            if (totalRate >= 100) {
                totalOutput.style.color = '#d32f2f';
                if (calculateButton) {
                    calculateButton.disabled = true;
                    calculateButton.textContent = 'ERROR! Total Persentase Melebihi 100%';
                }
            } else {
                totalOutput.style.color = '#4CAF50';
                if (calculateButton) {
                    calculateButton.disabled = false;
                    calculateButton.textContent = 'Kalkulasi';
                }
            }
        }
    }
    
    function calculateMarketplacePrice() {
        const modalInput = document.getElementById('modalPrice');
        
        const rawModalPrice = modalInput?.value.replace(/\./g, '') || '0';
        const modalPrice = parseFloat(rawModalPrice) || 0; 
        
        const mpFeeRate = parseFloat(document.getElementById('mpFeeRate')?.value) / 100 || 0;
        const adsBudgetRate = parseFloat(document.getElementById('adsBudgetRate')?.value) / 100 || 0;
        const affiliateBudgetRate = parseFloat(document.getElementById('affiliateBudgetRate')?.value) / 100 || 0; 
        const operationalBudgetRate = parseFloat(document.getElementById('operationalBudgetRate')?.value) / 100 || 0;
        const profitMarginRate = parseFloat(document.getElementById('profitMarginRate')?.value) / 100 || 0;

        const minSellingPriceOutput = document.getElementById('minSellingPriceOutput');
        const profitAmountOutput = document.getElementById('profitAmountOutput');
        const mpFeeAmountOutput = document.getElementById('mpFeeAmountOutput');
        const adsAmountOutput = document.getElementById('adsAmountOutput');
        const affiliateAmountOutput = document.getElementById('affiliateAmountOutput');
        const operationalAmountOutput = document.getElementById('operationalAmountOutput');
        const modalPriceOutput = document.getElementById('modalPriceOutput');

        if (!minSellingPriceOutput || !profitAmountOutput || !mpFeeAmountOutput || !adsAmountOutput || !affiliateAmountOutput || !operationalAmountOutput || !modalPriceOutput) { 
            return; 
        }
        
        const totalRateFraction = mpFeeRate + adsBudgetRate + affiliateBudgetRate + operationalBudgetRate + profitMarginRate;

        if (totalRateFraction >= 1) {
            minSellingPriceOutput.textContent = "ERROR!";
            profitAmountOutput.textContent = formatCurrency(0);
            mpFeeAmountOutput.textContent = formatCurrency(0);
            adsAmountOutput.textContent = formatCurrency(0);
            affiliateAmountOutput.textContent = formatCurrency(0);
            operationalAmountOutput.textContent = formatCurrency(0);
            modalPriceOutput.textContent = formatCurrency(modalPrice); 
            return;
        }

        const minSellingPrice = modalPrice / (1 - totalRateFraction);
        
        const profitAmount = minSellingPrice * profitMarginRate;
        const mpFeeAmount = minSellingPrice * mpFeeRate;
        const adsAmount = minSellingPrice * adsBudgetRate;
        const affiliateAmount = minSellingPrice * affiliateBudgetRate;
        const operationalAmount = minSellingPrice * operationalBudgetRate;

        minSellingPriceOutput.textContent = formatCurrency(minSellingPrice);
        profitAmountOutput.textContent = formatCurrency(profitAmount);
        mpFeeAmountOutput.textContent = formatCurrency(mpFeeAmount);
        adsAmountOutput.textContent = formatCurrency(adsAmount);
        affiliateAmountOutput.textContent = formatCurrency(affiliateAmount);
        operationalAmountOutput.textContent = formatCurrency(operationalAmount);
        modalPriceOutput.textContent = formatCurrency(modalPrice);
    }


    function setupSliderSync(sliderId, numberId) {
        const slider = document.getElementById(sliderId);
        const numberInput = document.getElementById(numberId);

        if (slider && numberInput) {
            slider.addEventListener('input', () => {
                numberInput.value = slider.value;
                updateTotalVariable();
            });

            numberInput.addEventListener('input', () => {
                let val = parseFloat(numberInput.value);
                const max = parseFloat(slider.max);
                const min = parseFloat(slider.min);
                
                if (val > max) {
                    val = max;
                    numberInput.value = max;
                } else if (val < min) {
                    val = min;
                    numberInput.value = min;
                }
                slider.value = val;
                updateTotalVariable();
            });
            
            numberInput.value = slider.value;
        }
    }

    document.addEventListener('DOMContentLoaded', () => {
        
        const modalInput = document.getElementById('modalPrice');
        if (modalInput) {
            modalInput.addEventListener('input', function() {
                formatModalPrice(this);
            });
            formatModalPrice(modalInput); 
        }

        setupSliderSync('mpFeeRateSlider', 'mpFeeRate');
        setupSliderSync('adsBudgetRateSlider', 'adsBudgetRate');
        setupSliderSync('affiliateBudgetRateSlider', 'affiliateBudgetRate'); 
        setupSliderSync('operationalBudgetRateSlider', 'operationalBudgetRate');
        setupSliderSync('profitMarginRateSlider', 'profitMarginRate');
        
        const calculateButton = document.getElementById('calculateButton');
        
        if (calculateButton) {
            calculateButton.addEventListener('click', calculateMarketplacePrice);
        }
        
        updateTotalVariable();
        calculateMarketplacePrice();
    });
</script>
</html>
